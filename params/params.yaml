# simulation final time and time step
tf: 120.0
dt: 0.004
use_random_seed: true
accurate_integration: true
log_directory: "../logs"
control_using_estimates: false
save_pixel_measurements: false

# Truth Configuration
use_accel_truth: false
use_gyro_truth: false
use_camera_truth: false
use_mocap_truth: false

x0: [0, 0, 0,    # POS
     0, 0, 0,    # VEL
     0, 0, 0,    # LIN ACC
     1, 0, 0, 0, # ATT
     0, 0, 0,    # OMEGA
     0, 0, 0]    # ANG ACC


# Controller Configuration
throttle_eq: 0.5
mass: 10.0
max_thrust: 196.133
inertia: [0.6271, 0.6271, 1.25]
linear_drag: [0.1, 0.1, 0.001]
angular_drag: [0.001, 0.001, 0.001]

Kp: [1, 1, 1]
Kd: [0.0, 0.0, 0.0]
Kv: [1, 1, 1]

roll_kp: 10.0
roll_ki: 0.0
roll_kd: 1.0
pitch_kp: 10.0
pitch_ki: 0.0
pitch_kd: 1.0
yaw_rate_kp: 1.0
yaw_rate_ki: 0.0
yaw_rate_kd: 0.0
max_roll: 1.0
max_pitch: 1.0
max_yaw_rate: 1.5
max_throttle: 1.0
max_vel: 6.0
max_tau_x: 200.0
max_tau_y: 200.0
max_tau_z: 100.0

# 0: waypoints
# 1: trajectory
# 2: circumnavigation
path_type: 0

waypoints: [0, 0, -4, 0,
            10, 0, -4, 0,
            10, 0, -8, 1.57,
            10, 10, -8, 1.57,
            10, 10, -4, 3.14,
            -10, 10, -4, 3.14,
            -10, 10, -8, -1.57,
            -10, -10, -8, -1.57,
            -10, -10, -4, 0,
            10, -10, -4, 0,
            10, 0, -4, 1.57]
waypoint_threshold: 0.1
waypoint_velocity_threshold: 0.5

traj_delta_north: 10
traj_delta_east: 10
traj_delta_alt: -4
traj_delta_yaw: 1.5
traj_nom_north: 0
traj_nom_east: 0
traj_nom_alt: 5
traj_nom_yaw: 0
traj_north_period: 20
traj_east_period: 20
traj_alt_period: 20
traj_yaw_period: 20

circ_rd: 5.0
circ_hd: 5.0
circ_kr: 5.0
circ_kp: 5.0
circ_kh: 5.0

# Environment Setup
enable_wind: false # Turn wind on and off
wind_init_stdev: 1.0 # Variation on the initial wind direction
wind_walk_stdev: 0.2 # Amount of random walk in wind components
wall_pts_density: 5 # Average points per square meter of wall
wall_max_deviation: 0.2 # Maximum deviation from wall center
wall_north_dim: 30 # Total room length in north dimension
wall_east_dim: 30 # Total room length in east dimension
wall_height: 10 # Total room height


# Sensor Configuration

## IMU
imu_update_rate: 250
p_bu: [0.05, 0.01, 0.02] # translation from body to IMU in body frame
q_bu: [0.5, 0.5, 0.5, 0.5] # rotation from body to IMU frame

accel_noise_stdev: 0.005
accel_bias_init_bound: 0.5
accel_walk_stdev: 0.01

gyro_noise_stdev: 0.001
gyro_bias_init_bound: 0.2
gyro_walk_stdev: 0.001

## Camera
camera_update_rate: 50
pixel_noise_stdev: 0.5
image_size: [640, 480]
camera_matrix: [480,   0, 320,
                  0, 480, 240,
                  0,   0,   1]
p_bc: [0.1, 0, 0.05] # translation from body to camera in body frame
q_bc: [0.5, 0.5, 0.5, 0.5] # rotation from body to camera

## Motion Capture
mocap_update_rate: 50
mocap_noise_stdev: 0.001
p_bm: [0.1, 0.1, 0.1] # translation from body to mocap_body in body frame
q_bm: [0.9928, 0.0447, 0.0547, 0.0971] # rotation from body to mocap_body

## Depth
## Altimeter
## Barometer
## Magnetometer
## GPS


# Estimator Configuration
xhat0: [0, 0, 0,   # POS
        1, 0, 0, 0, # ATT
        0, 0, 0,    # VEL
        0, 0, 0,    # OMEGA
        0, 0, 0]    # ACC

P0_diag: [0.001, 0.001, 0.001, # POS
          0.001, 0.001, 0.001, # ATT
          0.001, 0.001, 0.001, # VEL
          0.1, 0.1, 0.1, # OMEGA
          0.2, 0.2, 0.2] # ACC

Qx_diag: [0.001, 0.001, 0.001, # POS
          0.0, 0.0, 0.0, # ATT
          0.0001, 0.0001, 0.0001, # VEL
          0.000000000016, 0.000000000016, 0.000000000016, # OMEGA
          0.0000000016, 0.0000000016, 0.0000000016] # ACC

Qu_diag: [0.00000016, 0.00000016, 0.00000016, # OMEGA
          0.000004, 0.000004, 0.000004] # ACC

R_vo_diag: [0.01, 0.01, # Translation Direction
            0.001, 0.001, 0.001] # Rotation

vo_meas_gate_upper: 16.75 # bounds for 99% chi^2 test
vo_meas_gate_lower: 0.412

lambda: [1, 1, 1, # POS
         1, 1, 1, # ATT
         1, 1, 1, # VEL
         1, 1, 1, # OMEGA
         1, 1, 1] # ACC

pixel_disparity_threshold: 20
max_tracked_features: 200
min_kf_feature_matches: 100

# Bicyle setup
bicycle_accurate_integration: true
bicycle_mass: 1.0
bicycle_inertia: 0.1
bicycle_length: 1.5
bicycle_max_force: 10.0
bicycle_max_torque: 1.0
bicycle_max_steering_angle: 0.78
bicycle_k_u: 5.0
bicycle_k_theta: 5.0
bicycle_k_psi: 5.0
bicycle_velocity_command: 1.0
bicycle_x0: [2, # NORTH
             0, # EAST
             0, # DOWN
             0, # HEADING
             1.0, # VELOCITY
             0] # STEERING ANGLE
bicycle_waypoints: [8, 8,
                    -8, 8,
                    -8, -8,
                    8, -8]
bicycle_waypoint_threshold: 1.0
bicycle_flat_ground: false

# Target estimation parameters
bearing_only: true
use_target_truth: false
target_z0: [5, 0, 0]
target_vz0: [0, 0, 0]
target_gain: 1.0
target_velocity_gain: 1.0
target_noise_stdev: 1.0
